<div class="city-journey-card" data-edit-journey-target="card">
  <%= image_tag("#{city_journey.city.name}.jpg", :class => "city-card-picture") %>
  <div class="city-journey-info <%= 'd-none' if city_journey.errors.any? %>" data-edit-journey-target="infos">
    <h4> <strong> <%= city_journey.city.name %> </strong> <%= "from #{city_journey.start_date.strftime("%a %d %B")} to #{city_journey.end_date.strftime("%a %d %B")}" %> </h4>
        <div data-controller="read-more" data-read-more-more-text-value="Things to do" data-read-more-less-text-value="See less">
          <p data-read-more-target="content"></p>
          <button class="btn link-cust" data-action="read-more#toggle">Things to do</button>
          <template data-read-more-target="full">
      <% city_journey.city.activities.each do |activity| %>
        <ul>
          <li> <strong> <%= activity.name %> </strong> <%= ": #{activity.description}" %> </li>
        </ul>
      <% end %>
          </template>
        </div>

    <button class="btn link-cust" aria-label="Edit stop" data-action="click->edit-journey#displayForm">
      <i class="fa-solid fa-pen fa-xs ml-2" ></i>
      <p>Change this leg</p>
    </button>
  </div>
  <%= simple_form_for city_journey,
    html: {
      class: city_journey.errors.any? ? "" : "d-none",
      data: {
        edit_journey_target: "form",
        action: "submit->edit-journey#update",
        controller: 'flatpickr'
      }
    } do |f|
    %>
    <div class="m-3">
      <div class="edit-form">
        <%= f.input :start_date, as: :string, input_html: { data: { flatpickr_target: "startDate" } } %>
        <%= f.input :end_date, as: :string, input_html: { data: { flatpickr_target: "endDate" } } %>
      </div>
      <%= f.association :city, collection: City.order("name") %>
      <%= f.submit "Update journey", class: "btn btn-sm btn-primary btn-block mt-2" %>
    </div>
    <% end %>
</div>
